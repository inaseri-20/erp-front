<app-page-header [pageTitle]="'افزودن ساب تسک ها'"
                 [firstButtonIcon]="'arrow_back'"
                 (firstButtonAction)="router.navigate(['/task/sub-task/' + taskId])">
</app-page-header>

<div class='row mt-4'>

  <div class='col-md-10 col-12 mx-auto'>

    <mat-card>

      <mat-card-content>

        <form [formGroup]='subTaskForm'>

          <div class='row'>

            <div class='col-md-10 col-12 mx-auto'>

              <div class='row'>

                <div class='col-md-6 col-12'>

                  <mat-form-field appearance='outline' class='w-100'>
                    <mat-label>کاربر</mat-label>
                    <mat-select formControlName='user'>
                      <mat-option *ngFor='let user of users'
                                  [value]='user.id'>
                        {{user.first_name}} {{user.last_name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>

                </div>

                <div class='col-md-6 col-12'>

                  <mat-form-field appearance='outline' class='w-100'>
                    <mat-label>توضیحات</mat-label>
                    <input matInput formControlName='message'>
                  </mat-form-field>

                </div>

              </div>

              <ng-container formArrayName='files'>

                <ng-container *ngFor='let file of files.controls; let i = index'>

                  <div class='row' [formGroupName]="i">

                    <div class='col-md-9 col-9'>
                      <mat-form-field appearance='outline' class='w-100'>
                        <input matInput formControlName='fileName'>
                      </mat-form-field>
                    </div>

                    <div class='col-md-3 col-3'>
                      <button mat-mini-fab (click)='deleteFile(i)' color='warn'>
                        <mat-icon>delete_forever</mat-icon>
                      </button>

                      <button mat-mini-fab (click)='addFile()' class='ms-5' type='button'>
                        <mat-icon>add</mat-icon>
                      </button>
                    </div>
                  </div>

                </ng-container>


                <div class='row'>
                  <div class='col-md-12'>
                    <button mat-raised-button color='primary'>ثبت</button>
                  </div>
                </div>

              </ng-container>

            </div>

          </div>

        </form>

      </mat-card-content>

    </mat-card>

  </div>

</div>
