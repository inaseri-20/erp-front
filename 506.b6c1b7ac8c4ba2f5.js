"use strict";(self.webpackChunkerp_front=self.webpackChunkerp_front||[]).push([[506],{506:(J,h,n)=>{n.r(h),n.d(h,{AuthModule:()=>U});var C=n(9808),r=n(3075),e=n(5e3),y=n(2340),F=n(5916);let f=(()=>{class u{constructor(t){this.apiService=t,this.authBaseUrl=`${y.N.apiUrl}auth/`}loginUser(t){return this.apiService.post(`${this.authBaseUrl}verify/`,null,null,t)}verify(t){return this.apiService.post(`${this.authBaseUrl}login/${t.username}/`,null,null,t)}}return u.\u0275fac=function(t){return new(t||u)(e.LFG(F.s))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();var a=n(9826),p=n(7729),m=n(9224),s=n(3489),c=n(7531),d=n(7423);const S=function(){return["/auth/login"]},b=[{path:"login",component:(()=>{class u{constructor(t,o,l,g){this.formBuilder=t,this.authService=o,this.router=l,this.alertService=g,this.loading=!1}ngOnInit(){this.createForm()}createForm(){this.loginForm=this.formBuilder.group({username:["",[r.kI.required]]})}login(){this.loading=!0,this.authService.loginUser(this.loginForm.value).subscribe(t=>{this.alertService.messageSuccess(t.msg),this.loading=!1,this.router.navigate(["/auth/verify/"+this.loginForm.value.username])},t=>{this.alertService.messageError(t),this.loading=!1})}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(r.qu),e.Y36(f),e.Y36(a.F0),e.Y36(p.c))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-login"]],decls:16,vars:4,consts:[[1,"container","justify-content-center",2,"min-height","100vh","display","flex"],[1,"row"],[1,"col-md-12","col-12","mx-auto","d-grid","align-content-center"],[1,"mat-elevation-z18","rounded","rounded-3","border","border-0"],[1,"text-center","p-5"],[3,"formGroup","ngSubmit"],[1,"col-md-12","col-12","text-end"],[1,"text-center","mt-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","username","type","text"],["mat-raised-button","","color","accent","type","submit",1,"mx-auto","me-0",3,"disabled"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-card",3)(4,"mat-card-content",4)(5,"form",5),e.NdJ("ngSubmit",function(){return o.login()}),e.TgZ(6,"div",1)(7,"div",6)(8,"h2",7),e._uU(9,"\u0628\u0647 \u0633\u06cc\u0633\u062a\u0645 \u0645\u062f\u06cc\u0631\u06cc\u062a \u06a9\u0627\u0631 \u062e\u0648\u0634 \u0622\u0645\u062f\u06cc\u062f"),e.qZA(),e.TgZ(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644"),e.qZA(),e._UZ(13,"input",9),e.qZA(),e.TgZ(14,"button",10),e._uU(15,"\u0648\u0631\u0648\u062f "),e.qZA()()()()()()()()()),2&t&&(e.xp6(5),e.Q6J("formGroup",o.loginForm),e.xp6(9),e.ekj("spinner",o.loading),e.Q6J("disabled",o.loading))},directives:[m.a8,m.dn,r._Y,r.JL,r.sg,s.KE,s.hX,c.Nt,r.Fj,r.JJ,r.u,d.lW],styles:[""]}),u})()},{path:"verify/:tell",component:(()=>{class u{constructor(t,o,l,g,T){this.formBuilder=t,this.alertService=o,this.autService=l,this.activatedRoute=g,this.router=T,this.loading=!1}ngOnInit(){this.createForm()}createForm(){this.verifyCodeForm=this.formBuilder.group({code:["",[r.kI.required]],username:[this.activatedRoute.snapshot.params.tell]})}verify(){this.loading=!0,this.autService.verify(this.verifyCodeForm.value).subscribe(t=>{this.loading=!1,localStorage.setItem("erpAccessToken",t.access),localStorage.setItem("erpRefreshToken",t.refresh),localStorage.setItem("group",t.group),localStorage.setItem("erpUserFullName",t.full_name),t.group.includes("client")?this.router.navigate(["/task"]):this.router.navigate(["/admin/dashboard"]),this.alertService.messageSuccess(t.msg)},t=>{this.loading=!1,this.alertService.messageError(t)})}getCode(){this.loading=!0,this.autService.loginUser(this.verifyCodeForm.value).subscribe(t=>{this.loading=!1,this.alertService.messageSuccess(t.msg)},t=>{this.alertService.messageError(t),this.loading=!1})}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(r.qu),e.Y36(p.c),e.Y36(f),e.Y36(a.gz),e.Y36(a.F0))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-verify"]],decls:24,vars:9,consts:[[1,"container","justify-content-center",2,"min-height","100vh","display","flex"],[1,"row"],[1,"col-md-12","col-12","mx-auto","d-grid","align-content-center"],[1,"mat-elevation-z18","rounded","rounded-3","border","border-0"],[1,"text-center","p-5"],[3,"formGroup","ngSubmit"],[1,"col-md-12","col-12","text-end"],[1,"text-center","mt-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","username","type","text","readonly",""],[3,"routerLink"],["matInput","","formControlName","code","type","tell"],["mat-raised-button","","color","accent","type","button",1,"mx-auto","me-2",3,"disabled","click"],["mat-raised-button","","color","warn","type","submit",1,"mx-auto","me-0",3,"disabled"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-card",3)(4,"mat-card-content",4)(5,"form",5),e.NdJ("ngSubmit",function(){return o.verify()}),e.TgZ(6,"div",1)(7,"div",6)(8,"h3",7),e._uU(9,"\u0628\u0647 \u0633\u06cc\u0633\u062a\u0645 \u0645\u062f\u06cc\u0631\u06cc\u062a \u06a9\u0627\u0631 \u062e\u0648\u0634 \u0622\u0645\u062f\u06cc\u062f"),e.qZA(),e.TgZ(10,"mat-form-field",8)(11,"mat-label"),e._uU(12,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 \u0634\u0645\u0627"),e.qZA(),e._UZ(13,"input",9),e.TgZ(14,"mat-hint",10),e._uU(15,"\u0634\u0645\u0627\u0631\u0647 \u0648\u0627\u0631\u062f \u0634\u062f\u0647 \u0627\u0634\u062a\u0628\u0627\u0647 \u0627\u0633\u062a\u061f"),e.qZA()(),e.TgZ(16,"mat-form-field",8)(17,"mat-label"),e._uU(18,"\u06a9\u062f \u067e\u06cc\u0627\u0645\u06a9 \u0634\u062f\u0647"),e.qZA(),e._UZ(19,"input",11),e.qZA(),e.TgZ(20,"button",12),e.NdJ("click",function(){return o.getCode()}),e._uU(21,"\u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u062c\u062f\u062f \u0631\u0645\u0632 \u0639\u0628\u0648\u0631 "),e.qZA(),e.TgZ(22,"button",13),e._uU(23,"\u0648\u0631\u0648\u062f "),e.qZA()()()()()()()()()),2&t&&(e.xp6(5),e.Q6J("formGroup",o.verifyCodeForm),e.xp6(9),e.Q6J("routerLink",e.DdM(8,S)),e.xp6(6),e.ekj("spinner",o.loading),e.Q6J("disabled",o.loading),e.xp6(2),e.ekj("spinner",o.loading),e.Q6J("disabled",o.loading))},directives:[m.a8,m.dn,r._Y,r.JL,r.sg,s.KE,s.hX,c.Nt,r.Fj,r.JJ,r.u,s.bx,a.rH,d.lW],styles:[""]}),u})()}];let Z=(()=>{class u{}return u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[[a.Bz.forChild(b)],a.Bz]}),u})();var v=n(8966);let U=(()=>{class u{}return u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({providers:[v.vA],imports:[[C.ez,Z,m.QW,s.lN,c.c,d.ot,r.UX,v.Is]]}),u})()}}]);